var mysql = require("mysql");
const dbConnection = require('dbConnection.js');

async function validateUser(UserID) {

    const con = await dbConnection.connectDB(
        process.env.DatabaseAddress,
        'user',
        'Password1234',
        'databaseAmazonianPrime',
    );

    const getUserQuery = `SELECT *
                          FROM Users
                          WHERE UserID = ${parseInt(UserID)}`;

    const getUser = await new Promise((resolve, reject) => {
        con.query(getUserQuery, function (err, res) {
            if (err) {
                reject("Couldn't get the user from database!");
            }
            resolve(res);
        });
    });
    if (getUser.length < 1) {
        return {
            statusCode: 404,
            body: `Missing UserID. Please provide a UserID in the request body.`,
        };
    }

    if (getUser.length < 1) {
        return {
            statusCode: 404,
            body: `User with UserID ${UserID} not found`,
        };
    }
}

module.exports = { validateUser };
